<!DOCTYPE html>
<html lang="vi">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Qu·∫£n L√Ω Chi Ti√™u</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .container {
      width: 100%;
      max-width: 1200px;
      padding: 20px;
    }

    .auth-container {
      background: white;
      border-radius: 10px;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
      padding: 40px;
      max-width: 400px;
      margin: 0 auto;
    }

    .form-group {
      margin-bottom: 20px;
    }

    label {
      display: block;
      margin-bottom: 8px;
      color: #333;
      font-weight: 500;
    }

    input {
      width: 100%;
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 5px;
      font-size: 14px;
    }

    input:focus {
      outline: none;
      border-color: #2196f3;
      box-shadow: 0 0 5px rgba(33, 150, 243, 0.3);
    }

    button {
      width: 100%;
      padding: 12px;
      background: linear-gradient(135deg, #42a5f5 0%, #2196f3 100%);
      color: white;
      border: none;
      border-radius: 5px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      box-shadow: 0 2px 8px rgba(33, 150, 243, 0.3);
    }

    button:hover {
      background: linear-gradient(135deg, #1e88e5 0%, #1976d2 100%);
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(33, 150, 243, 0.4);
    }

    .toggle-form {
      text-align: center;
      margin-top: 20px;
      color: #666;
    }

    .toggle-form a {
      color: #2196f3;
      cursor: pointer;
      text-decoration: none;
      font-weight: 600;
    }

    .dashboard {
      display: none;
      background: white;
      border-radius: 10px;
      padding: 30px;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
    }

    .dashboard.active {
      display: block;
    }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
      border-bottom: 2px solid #f0f0f0;
      padding-bottom: 20px;
    }

    .header h1 {
      color: #333;
    }

    .logout-btn {
      background: #e74c3c;
      padding: 10px 20px;
      width: auto;
    }

    .logout-btn:hover {
      background: #c0392b;
    }

    .stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .stat-card {
      background: linear-gradient(135deg, #e8f5e8 0%, #c8e6c9 100%);
      color: #2e7d32;
      padding: 20px;
      border-radius: 10px;
      text-align: center;
      border: 1px solid #a5d6a7;
      box-shadow: 0 2px 8px rgba(76, 175, 80, 0.1);
    }

    .stat-card h3 {
      font-size: 14px;
      margin-bottom: 10px;
      opacity: 0.9;
    }

    .stat-card .value {
      font-size: 28px;
      font-weight: bold;
    }

    .section {
      margin-bottom: 30px;
    }

    .section h2 {
      color: #333;
      margin-bottom: 15px;
      font-size: 20px;
    }

    .form-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 15px;
    }

    table th {
      background: #f5f5f5;
      padding: 12px;
      text-align: left;
      font-weight: 600;
      color: #333;
      border-bottom: 2px solid #ddd;
    }

    table td {
      padding: 12px;
      border-bottom: 1px solid #eee;
    }

    table tr:hover {
      background: #f9f9f9;
    }

    .alert {
      padding: 15px;
      border-radius: 5px;
      margin-bottom: 20px;
      display: none;
    }

    .alert.success {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
      display: block;
    }

    .alert.error {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
      display: block;
    }

    .nav-tabs {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
      border-bottom: 2px solid #f0f0f0;
    }

    .nav-tabs button {
      background: none;
      border: none;
      padding: 10px 20px;
      color: #666;
      cursor: pointer;
      font-weight: 600;
      border-bottom: 3px solid transparent;
      transition: all 0.3s;
    }

    .nav-tabs button.active {
      color: #667eea;
      border-bottom-color: #667eea;
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
    }

    select {
      width: 100%;
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 5px;
      font-size: 14px;
      background: white;
    }

    select:focus {
      outline: none;
      border-color: #2196f3;
      box-shadow: 0 0 5px rgba(33, 150, 243, 0.3);
    }

    @media (max-width: 768px) {
      .container {
        padding: 10px;
      }

      .stats {
        grid-template-columns: 1fr;
      }

      .form-row {
        grid-template-columns: 1fr;
      }

      .nav-tabs {
        flex-wrap: wrap;
      }

      .nav-tabs button {
        font-size: 12px;
        padding: 8px 12px;
      }

      table {
        font-size: 12px;
      }

      table th,
      table td {
        padding: 8px;
      }

      .form-row {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>

<body>
  <div class="container">
    <!-- Auth Forms -->
    <div id="authContainer" class="auth-container">
      <div id="loginForm">
        <h2 style="margin-bottom: 30px; color: #333">ƒêƒÉng Nh·∫≠p</h2>
        <div class="alert" id="loginAlert"></div>
        <div class="form-group">
          <label>Email</label>
          <input type="email" id="loginEmail" placeholder="Nh·∫≠p email" />
        </div>
        <div class="form-group">
          <label>M·∫≠t Kh·∫©u</label>
          <input type="password" id="loginPassword" placeholder="Nh·∫≠p m·∫≠t kh·∫©u" />
        </div>
        <button onclick="login()">ƒêƒÉng Nh·∫≠p</button>
        <div class="toggle-form">
          Ch∆∞a c√≥ t√†i kho·∫£n? <a onclick="toggleForm()">ƒêƒÉng K√Ω</a>
        </div>
      </div>

      <div id="registerForm" style="display: none">
        <h2 style="margin-bottom: 30px; color: #333">ƒêƒÉng K√Ω</h2>
        <div class="alert" id="registerAlert"></div>
        <div class="form-group">
          <label>H·ªç T√™n</label>
          <input type="text" id="registerName" placeholder="Nh·∫≠p h·ªç t√™n" />
        </div>
        <div class="form-group">
          <label>Email</label>
          <input type="email" id="registerEmail" placeholder="Nh·∫≠p email" />
        </div>
        <div class="form-group">
          <label>M·∫≠t Kh·∫©u</label>
          <input type="password" id="registerPassword" placeholder="Nh·∫≠p m·∫≠t kh·∫©u" />
        </div>
        <div class="form-group">
          <label>S·ªë D∆∞ Ban ƒê·∫ßu</label>
          <input type="number" id="registerBalance" placeholder="Nh·∫≠p s·ªë d∆∞" value="0" />
        </div>
        <button onclick="register()">ƒêƒÉng K√Ω</button>
        <div class="toggle-form">
          ƒê√£ c√≥ t√†i kho·∫£n? <a onclick="toggleForm()">ƒêƒÉng Nh·∫≠p</a>
        </div>
      </div>
    </div>

    <!-- Dashboard -->
    <div id="dashboard" class="dashboard">
      <div class="header">
        <h1>Qu·∫£n L√Ω Chi Ti√™u</h1>
        <button class="logout-btn" onclick="logout()">ƒêƒÉng Xu·∫•t</button>
      </div>

      <div class="alert" id="dashboardAlert"></div>

      <div class="stats">
        <div class="stat-card">
          <h3>Thu Nh·∫≠p Th√°ng N√†y</h3>
          <div class="value" id="monthlyIncome">0 VNƒê</div>
        </div>
        <div class="stat-card">
          <h3>Chi Ti√™u Th√°ng N√†y</h3>
          <div class="value" id="monthlyExpense">0 VNƒê</div>
        </div>
        <div class="stat-card">
          <h3>S·ªë D∆∞ Hi·ªán T·∫°i</h3>
          <div class="value" id="currentBalance">0 VNƒê</div>
        </div>
      </div>

      <div class="nav-tabs">
        <button class="active" onclick="switchTab('transactions')">
          Giao D·ªãch
        </button>
        <button onclick="switchTab('categories')">Danh M·ª•c</button>
        <button onclick="window.location.href='ocr_hoadon.html'" style="
              background: linear-gradient(135deg, #f8fafa 0%, #f8fafa 100%);
              color: #666;
              border-radius: 5px;
            ">
          Qu√©t H√≥a ƒê∆°n
        </button>
        <button onclick="window.location.href='voice_receipt.html'" style="
              background: linear-gradient(135deg, #f5f6f5 0%, #f8f9f8 100%);
              color: #666;
              border-radius: 5px;
            ">
          Gi·ªçng N√≥i
        </button>
        <button onclick="window.location.href='ai.html'" style="
              background: linear-gradient(135deg, #f5f6f5 0%, #f8f9f8 100%);
              color: #666;
              border-radius: 5px;
            ">
          AI T∆∞ V·∫•n
        </button>
      </div>

      <!-- Tab Content -->
      <div id="transactionsTab" class="tab-content">
        <div class="section">
          <h2>Th√™m Giao D·ªãch</h2>
          <div class="form-row">
            <div class="form-group">
              <label>S·ªë Ti·ªÅn</label>
              <input type="number" id="transactionAmount" placeholder="Nh·∫≠p s·ªë ti·ªÅn" />
            </div>
            <div class="form-group">
              <label>Danh M·ª•c</label>
              <select id="transactionCategory">
                <option value="">Ch·ªçn danh m·ª•c</option>
              </select>
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>M√¥ T·∫£</label>
              <input type="text" id="transactionDescription1" placeholder="M√¥ t·∫£ giao d·ªãch" />
            </div>
            <div class="form-group">
              <label>Ng√†y</label>
              <input type="date" id="transactionDate" />
            </div>
          </div>
          <button onclick="addTransaction()">Th√™m Giao D·ªãch</button>
        </div>

        <div class="section">
          <h2>L·ªãch S·ª≠ Giao D·ªãch</h2>
          <table>
            <thead>
              <tr>
                <th>Ng√†y</th>
                <th>Danh M·ª•c</th>
                <th>S·ªë Ti·ªÅn</th>
                <th>M√¥ T·∫£</th>
              </tr>
            </thead>
            <tbody id="transactionTableBody">
              <!-- Transactions will be loaded here -->
            </tbody>
          </table>
        </div>
      </div>

      <div id="categoriesTab" class="tab-content" style="display: none;">
        <div class="section">
          <h2>Th√™m Danh M·ª•c</h2>
          <div class="form-row">
            <div class="form-group">
              <label>T√™n Danh M·ª•c</label>
              <input type="text" id="categoryName1" placeholder="Nh·∫≠p t√™n danh m·ª•c" />
            </div>
            <div class="form-group">
              <label>Lo·∫°i</label>
              <select id="categoryType">
                <option value="">Ch·ªçn lo·∫°i</option>
                <option value="Thu nh·∫≠p">Thu nh·∫≠p</option>
                <option value="Chi ti√™u">Chi ti√™u</option>
              </select>
            </div>
          </div>
          <div class="form-group">
            <label>Icon (t√πy ch·ªçn)</label>
            <input type="text" id="categoryIcon" placeholder="V√≠ d·ª•: üçî, üí∞, üéÆ" />
          </div>
          <button onclick="addCategory()">Th√™m Danh M·ª•c</button>
        </div>

        <div class="section">
          <h2>Danh S√°ch Danh M·ª•c</h2>
          <table>
            <thead>
              <tr>
                <th>Icon</th>
                <th>T√™n</th>
                <th>Lo·∫°i</th>
              </tr>
            </thead>
            <tbody id="categoryTableBody">
              <!-- Categories will be loaded here -->
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <script src="config.js"></script>
  <script src="app.js"></script>
</body>

</html> 5px;
            ">
          AI T∆∞ V·∫•n
        </button>
      </div>

      <!-- Transactions Tab -->
      <div id="transactionsTab" class="tab-content">
        <div class="section">
          <h2>Th√™m Giao D·ªãch</h2>
          <div class="form-row">
            <div class="form-group">
              <label>Lo·∫°i</label>
              <select id="transactionType">
                <option value="income">Thu Nh·∫≠p</option>
                <option value="expense">Chi Ti√™u</option>
              </select>
            </div>
            <div class="form-group">
              <label>S·ªë Ti·ªÅn</label>
              <input type="number" id="transactionAmount" placeholder="Nh·∫≠p s·ªë ti·ªÅn" />
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>Danh M·ª•c</label>
              <select id="transactionCategory">
                <option value="food">ƒÇn U·ªëng</option>
                <option value="transport">Di Chuy·ªÉn</option>
                <option value="shopping">Mua S·∫Øm</option>
                <option value="entertainment">Gi·∫£i Tr√≠</option>
                <option value="salary">L∆∞∆°ng</option>
                <option value="other">Kh√°c</option>
              </select>
            </div>
            <div class="form-group">
              <label>M√¥ T·∫£</label>
              <input type="text" id="transactionDescription" placeholder="M√¥ t·∫£ giao d·ªãch" />
            </div>
          </div>
          <button onclick="addTransaction()">Th√™m Giao D·ªãch</button>
        </div>

        <div class="section">
          <h2>L·ªãch S·ª≠ Giao D·ªãch</h2>
          <table id="transactionsTable">
            <thead>
              <tr>
                <th>Ng√†y</th>
                <th>Lo·∫°i</th>
                <th>Danh M·ª•c</th>
                <th>M√¥ T·∫£</th>
                <th>S·ªë Ti·ªÅn</th>
                <th>Thao T√°c</th>
              </tr>
            </thead>
            <tbody id="transactionsBody">
            </tbody>
          </table>
        </div>
      </div>

      <!-- Categories Tab -->
      <div id="categoriesTab" class="tab-content" style="display: none">
        <div class="section">
          <h2>Qu·∫£n L√Ω Danh M·ª•c</h2>
          <div class="form-row">
            <div class="form-group">
              <label>T√™n Danh M·ª•c</label>
              <input type="text" id="categoryName" placeholder="Nh·∫≠p t√™n danh m·ª•c" />
            </div>
            <div class="form-group">
              <label>Lo·∫°i</label>
              <select id="categoryType">
                <option value="expense">Chi Ti√™u</option>
                <option value="income">Thu Nh·∫≠p</option>
              </select>
            </div>
          </div>
          <button onclick="addCategory()">Th√™m Danh M·ª•c</button>
        </div>

        <div class="section">
          <h2>Danh S√°ch Danh M·ª•c</h2>
          <table id="categoriesTable">
            <thead>
              <tr>
                <th>T√™n</th>
                <th>Lo·∫°i</th>
                <th>Thao T√°c</th>
              </tr>
            </thead>
            <tbody id="categoriesBody">
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Data storage
    let users = JSON.parse(localStorage.getItem('users')) || [];
    let currentUser = JSON.parse(localStorage.getItem('currentUser')) || null;
    let transactions = JSON.parse(localStorage.getItem('transactions')) || [];
    let categories = JSON.parse(localStorage.getItem('categories')) || [
      { id: 1, name: 'ƒÇn U·ªëng', type: 'expense' },
      { id: 2, name: 'Di Chuy·ªÉn', type: 'expense' },
      { id: 3, name: 'Mua S·∫Øm', type: 'expense' },
      { id: 4, name: 'Gi·∫£i Tr√≠', type: 'expense' },
      { id: 5, name: 'L∆∞∆°ng', type: 'income' },
      { id: 6, name: 'Kh√°c', type: 'expense' }
    ];

    // Initialize app
    document.addEventListener('DOMContentLoaded', function() {
      if (currentUser) {
        showDashboard();
      }
      updateCategoryOptions();
    });

    // Auth functions
    function toggleForm() {
      const loginForm = document.getElementById('loginForm');
      const registerForm = document.getElementById('registerForm');
      
      if (loginForm.style.display === 'none') {
        loginForm.style.display = 'block';
        registerForm.style.display = 'none';
      } else {
        loginForm.style.display = 'none';
        registerForm.style.display = 'block';
      }
    }

    function register() {
      const name = document.getElementById('registerName').value;
      const email = document.getElementById('registerEmail').value;
      const password = document.getElementById('registerPassword').value;
      const balance = parseFloat(document.getElementById('registerBalance').value) || 0;
      
      if (!name || !email || !password) {
        showAlert('registerAlert', 'Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin', 'error');
        return;
      }
      
      if (users.find(u => u.email === email)) {
        showAlert('registerAlert', 'Email ƒë√£ t·ªìn t·∫°i', 'error');
        return;
      }
      
      const user = {
        id: Date.now(),
        name,
        email,
        password,
        balance,
        createdAt: new Date().toISOString()
      };
      
      users.push(user);
      localStorage.setItem('users', JSON.stringify(users));
      
      showAlert('registerAlert', 'ƒêƒÉng k√Ω th√†nh c√¥ng!', 'success');
      setTimeout(() => toggleForm(), 1500);
    }

    function login() {
      const email = document.getElementById('loginEmail').value;
      const password = document.getElementById('loginPassword').value;
      
      if (!email || !password) {
        showAlert('loginAlert', 'Vui l√≤ng nh·∫≠p email v√† m·∫≠t kh·∫©u', 'error');
        return;
      }
      
      const user = users.find(u => u.email === email && u.password === password);
      
      if (!user) {
        showAlert('loginAlert', 'Email ho·∫∑c m·∫≠t kh·∫©u kh√¥ng ƒë√∫ng', 'error');
        return;
      }
      
      currentUser = user;
      localStorage.setItem('currentUser', JSON.stringify(user));
      showDashboard();
    }

    function logout() {
      currentUser = null;
      localStorage.removeItem('currentUser');
      document.getElementById('authContainer').style.display = 'block';
      document.getElementById('dashboard').classList.remove('active');
    }

    function showDashboard() {
      document.getElementById('authContainer').style.display = 'none';
      document.getElementById('dashboard').classList.add('active');
      updateStats();
      loadTransactions();
      loadCategories();
    }

    // Transaction functions
    function addTransaction() {
      const type = document.getElementById('transactionType').value;
      const amount = parseFloat(document.getElementById('transactionAmount').value);
      const category = document.getElementById('transactionCategory').value;
      const description = document.getElementById('transactionDescription').value;
      
      if (!amount || amount <= 0) {
        showAlert('dashboardAlert', 'Vui l√≤ng nh·∫≠p s·ªë ti·ªÅn h·ª£p l·ªá', 'error');
        return;
      }
      
      const transaction = {
        id: Date.now(),
        userId: currentUser.id,
        type,
        amount,
        category,
        description,
        date: new Date().toISOString()
      };
      
      transactions.push(transaction);
      localStorage.setItem('transactions', JSON.stringify(transactions));
      
      // Update user balance
      if (type === 'income') {
        currentUser.balance += amount;
      } else {
        currentUser.balance -= amount;
      }
      
      // Update user in users array
      const userIndex = users.findIndex(u => u.id === currentUser.id);
      users[userIndex] = currentUser;
      localStorage.setItem('users', JSON.stringify(users));
      localStorage.setItem('currentUser', JSON.stringify(currentUser));
      
      // Clear form
      document.getElementById('transactionAmount').value = '';
      document.getElementById('transactionDescription').value = '';
      
      updateStats();
      loadTransactions();
      showAlert('dashboardAlert', 'Th√™m giao d·ªãch th√†nh c√¥ng!', 'success');
    }

    function deleteTransaction(id) {
      const transaction = transactions.find(t => t.id === id);
      if (!transaction) return;
      
      // Revert balance
      if (transaction.type === 'income') {
        currentUser.balance -= transaction.amount;
      } else {
        currentUser.balance += transaction.amount;
      }
      
      transactions = transactions.filter(t => t.id !== id);
      localStorage.setItem('transactions', JSON.stringify(transactions));
      
      // Update user
      const userIndex = users.findIndex(u => u.id === currentUser.id);
      users[userIndex] = currentUser;
      localStorage.setItem('users', JSON.stringify(users));
      localStorage.setItem('currentUser', JSON.stringify(currentUser));
      
      updateStats();
      loadTransactions();
    }

    function loadTransactions() {
      const userTransactions = transactions.filter(t => t.userId === currentUser.id);
      const tbody = document.getElementById('transactionsBody');
      
      tbody.innerHTML = userTransactions.map(t => `
        <tr>
          <td>${new Date(t.date).toLocaleDateString('vi-VN')}</td>
          <td>${t.type === 'income' ? 'Thu Nh·∫≠p' : 'Chi Ti√™u'}</td>
          <td>${getCategoryName(t.category)}</td>
          <td>${t.description}</td>
          <td>${formatCurrency(t.amount)}</td>
          <td><button onclick="deleteTransaction(${t.id})" style="background: #e74c3c; padding: 5px 10px; width: auto;">X√≥a</button></td>
        </tr>
      `).join('');
    }

    // Category functions
    function addCategory() {
      const name = document.getElementById('categoryName').value;
      const type = document.getElementById('categoryType').value;
      
      if (!name) {
        showAlert('dashboardAlert', 'Vui l√≤ng nh·∫≠p t√™n danh m·ª•c', 'error');
        return;
      }
      
      const category = {
        id: Date.now(),
        name,
        type
      };
      
      categories.push(category);
      localStorage.setItem('categories', JSON.stringify(categories));
      
      document.getElementById('categoryName').value = '';
      
      loadCategories();
      updateCategoryOptions();
      showAlert('dashboardAlert', 'Th√™m danh m·ª•c th√†nh c√¥ng!', 'success');
    }

    function deleteCategory(id) {
      categories = categories.filter(c => c.id !== id);
      localStorage.setItem('categories', JSON.stringify(categories));
      loadCategories();
      updateCategoryOptions();
    }

    function loadCategories() {
      const tbody = document.getElementById('categoriesBody');
      
      tbody.innerHTML = categories.map(c => `
        <tr>
          <td>${c.name}</td>
          <td>${c.type === 'income' ? 'Thu Nh·∫≠p' : 'Chi Ti√™u'}</td>
          <td><button onclick="deleteCategory(${c.id})" style="background: #e74c3c; padding: 5px 10px; width: auto;">X√≥a</button></td>
        </tr>
      `).join('');
    }

    function updateCategoryOptions() {
      const select = document.getElementById('transactionCategory');
      select.innerHTML = categories.map(c => 
        `<option value="${c.name}">${c.name}</option>`
      ).join('');
    }

    function getCategoryName(categoryValue) {
      return categoryValue;
    }

    // Tab functions
    function switchTab(tabName) {
      // Hide all tabs
      document.querySelectorAll('.tab-content').forEach(tab => {
        tab.style.display = 'none';
      });
      
      // Remove active class from all buttons
      document.querySelectorAll('.nav-tabs button').forEach(btn => {
        btn.classList.remove('active');
      });
      
      // Show selected tab
      document.getElementById(tabName + 'Tab').style.display = 'block';
      
      // Add active class to clicked button
      event.target.classList.add('active');
    }

    // Utility functions
    function updateStats() {
      const userTransactions = transactions.filter(t => t.userId === currentUser.id);
      const currentMonth = new Date().getMonth();
      const currentYear = new Date().getFullYear();
      
      const monthlyIncome = userTransactions
        .filter(t => {
          const date = new Date(t.date);
          return t.type === 'income' && date.getMonth() === currentMonth && date.getFullYear() === currentYear;
        })
        .reduce((sum, t) => sum + t.amount, 0);
      
      const monthlyExpense = userTransactions
        .filter(t => {
          const date = new Date(t.date);
          return t.type === 'expense' && date.getMonth() === currentMonth && date.getFullYear() === currentYear;
        })
        .reduce((sum, t) => sum + t.amount, 0);
      
      document.getElementById('monthlyIncome').textContent = formatCurrency(monthlyIncome);
      document.getElementById('monthlyExpense').textContent = formatCurrency(monthlyExpense);
      document.getElementById('currentBalance').textContent = formatCurrency(currentUser.balance);
    }

    function formatCurrency(amount) {
      return new Intl.NumberFormat('vi-VN', {
        style: 'currency',
        currency: 'VND'
      }).format(amount);
    }

    function showAlert(elementId, message, type) {
      const alert = document.getElementById(elementId);
      alert.textContent = message;
      alert.className = `alert ${type}`;
      alert.style.display = 'block';
      
      setTimeout(() => {
        alert.style.display = 'none';
      }, 3000);
    }
  </script>
</body>

</html> 5px;
            ">
          AI
        </button>
        <button onclick="switchTab('statistics')">Th·ªëng K√™</button>
        <button onclick="switchTab('debt')">Vay N·ª£</button>
        <button onclick="switchTab('savings')">Ti·∫øt Ki·ªám</button>
        <button onclick="switchTab('profile')">H·ªì S∆°</button>
      </div>

      <!-- Transactions Tab -->
      <div id="transactionsTab" class="section">
        <h2>Qu·∫£n L√Ω Giao D·ªãch</h2>
        <div class="form-row">
          <div class="form-group">
            <label>Danh M·ª•c</label>
            <select id="transactionCategory" style="
                  width: 100%;
                  padding: 12px;
                  border: 1px solid #ddd;
                  border-radius: 5px;
                ">
              <option value="">Ch·ªçn danh m·ª•c</option>
            </select>
            <div style="margin-top: 8px; font-size: 12px; color: #666">
              G·ª£i √Ω:
              <span style="color: #667eea; cursor: pointer" onclick="showCategorySuggestions()">Xem danh m·ª•c ph·ªï
                bi·∫øn</span>
            </div>
          </div>
          <div class="form-group">
            <label>S·ªë Ti·ªÅn</label>
            <input type="number" id="transactionAmount" placeholder="Nh·∫≠p s·ªë ti·ªÅn" />
          </div>
        </div>
        <div class="form-group">
          <label>M√¥ T·∫£</label>
          <input type="text" id="transactionDescription2" placeholder="Nh·∫≠p m√¥ t·∫£" />
        </div>
        <button onclick="addTransaction()">Th√™m Giao D·ªãch</button>

        <h3 style="margin-top: 30px; margin-bottom: 15px">
          L·ªãch S·ª≠ Giao D·ªãch
        </h3>
        <table>
          <thead>
            <tr>
              <th>Danh M·ª•c</th>
              <th>S·ªë Ti·ªÅn</th>
              <th>M√¥ T·∫£</th>
              <th>Ng√†y</th>
            </tr>
          </thead>
          <tbody id="transactionList"></tbody>
        </table>
      </div>

      <!-- Categories Tab -->
      <div id="categoriesTab" class="section" style="display: none">
        <h2>Qu·∫£n L√Ω Danh M·ª•c</h2>
        <div class="form-row">
          <div class="form-group">
            <label>Lo·∫°i Danh M·ª•c</label>
            <select id="categoryType" style="
                  width: 100%;
                  padding: 12px;
                  border: 1px solid #ddd;
                  border-radius: 5px;
                ">
              <option value="Chi ti√™u">Chi Ti√™u</option>
              <option value="Thu nh·∫≠p">Thu Nh·∫≠p</option>
            </select>
          </div>
          <div class="form-group">
            <label>T√™n Danh M·ª•c</label>
            <input type="text" id="categoryName2" placeholder="Nh·∫≠p t√™n danh m·ª•c" />
          </div>
        </div>
        <div class="form-group">
          <label>M√¥ T·∫£</label>
          <input type="text" id="categoryDescription" placeholder="Nh·∫≠p m√¥ t·∫£" />
        </div>
        <button onclick="addCategory()">Th√™m Danh M·ª•c</button>

        <h3 style="margin-top: 30px; margin-bottom: 15px">
          Danh S√°ch Danh M·ª•c
        </h3>
        <table>
          <thead>
            <tr>
              <th>T√™n Danh M·ª•c</th>
              <th>Lo·∫°i</th>
              <th>M√¥ T·∫£</th>
            </tr>
          </thead>
          <tbody id="categoryList"></tbody>
        </table>
      </div>

      <!-- Statistics Tab -->
      <div id="statisticsTab" class="section" style="display: none">
        <h2>Th·ªëng K√™ Chi Ti√™u</h2>
        <div class="form-row">
          <div class="form-group">
            <label>Th√°ng</label>
            <input type="number" id="statMonth" min="1" max="12" placeholder="Th√°ng" />
          </div>
          <div class="form-group">
            <label>NƒÉm</label>
            <input type="number" id="statYear" placeholder="NƒÉm" />
          </div>
        </div>
        <button onclick="loadDetailedStats()">Xem Th·ªëng K√™</button>

        <h3 style="margin-top: 30px; margin-bottom: 15px">
          B√°o C√°o Chi Ti·∫øt
        </h3>
        <table>
          <thead>
            <tr>
              <th>Danh M·ª•c</th>
              <th>Lo·∫°i</th>
              <th>T·ªïng Ti·ªÅn</th>
            </tr>
          </thead>
          <tbody id="statsList"></tbody>
        </table>
      </div>

      <!-- Debt Tab -->
      <div id="debtTab" class="section" style="display: none">
        <h2>Qu·∫£n L√Ω Vay N·ª£</h2>
        <div class="form-row">
          <div class="form-group">
            <label>H·ªç T√™n</label>
            <input type="text" id="debtName" placeholder="T√™n ng∆∞·ªùi vay/cho vay" />
          </div>
          <div class="form-group">
            <label>Lo·∫°i</label>
            <select id="debtType" style="
                  width: 100%;
                  padding: 12px;
                  border: 1px solid #ddd;
                  border-radius: 5px;
                ">
              <option value="Cho Vay">Cho Vay</option>
              <option value="M∆∞·ª£n N·ª£">M∆∞·ª£n N·ª£</option>
            </select>
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>S·ªë Ti·ªÅn</label>
            <input type="number" id="debtAmount" placeholder="S·ªë ti·ªÅn" />
          </div>
          <div class="form-group">
            <label>L√£i Su·∫•t (%)</label>
            <input type="number" id="debtRate" placeholder="L√£i su·∫•t" value="0" />
          </div>
        </div>
        <div class="form-group">
          <label>H·∫°n Tr·∫£</label>
          <input type="date" id="debtDue" />
        </div>
        <button onclick="addDebt()">Th√™m Kho·∫£n Vay/N·ª£</button>

        <h3 style="margin-top: 30px; margin-bottom: 15px">
          Danh S√°ch Vay N·ª£
        </h3>
        <table>
          <thead>
            <tr>
              <th>H·ªç T√™n</th>
              <th>Lo·∫°i</th>
              <th>S·ªë Ti·ªÅn</th>
              <th>Tr·∫°ng Th√°i</th>
              <th>H·∫°n Tr·∫£</th>
            </tr>
          </thead>
          <tbody id="debtList"></tbody>
        </table>
      </div>

      <!-- Savings Tab -->
      <div id="savingsTab" class="section" style="display: none">
        <h2>K·∫ø Ho·∫°ch Ti·∫øt Ki·ªám</h2>
        <div class="form-row">
          <div class="form-group">
            <label>T√™n M·ª•c Ti√™u</label>
            <input type="text" id="savingName" placeholder="V√≠ d·ª•: Mua nh√†" />
          </div>
          <div class="form-group">
            <label>S·ªë Ti·ªÅn M·ª•c Ti√™u</label>
            <input type="number" id="savingTarget" placeholder="S·ªë ti·ªÅn" />
          </div>
        </div>
        <div class="form-group">
          <label>Ng√†y K·∫øt Th√∫c</label>
          <input type="date" id="savingEnd" />
        </div>
        <button onclick="addSaving()">T·∫°o M·ª•c Ti√™u</button>

        <h3 style="margin-top: 30px; margin-bottom: 15px">
          Danh S√°ch Ti·∫øt Ki·ªám
        </h3>
        <table>
          <thead>
            <tr>
              <th>T√™n M·ª•c Ti√™u</th>
              <th>M·ª•c Ti√™u</th>
              <th>Tr·∫°ng Th√°i</th>
              <th>Ng√†y KT</th>
            </tr>
          </thead>
          <tbody id="savingsList"></tbody>
        </table>
      </div>

      <!-- Profile Tab -->
      <div id="profileTab" class="section" style="display: none">
        <h2>H·ªì S∆° C√° Nh√¢n</h2>
        <div class="form-group">
          <label>H·ªç T√™n</label>
          <input type="text" id="profileName" placeholder="Nh·∫≠p h·ªç t√™n" />
        </div>
        <div class="form-group">
          <label>Email</label>
          <input type="email" id="profileEmail" placeholder="Nh·∫≠p email" disabled />
        </div>
        <div class="form-group">
          <label>M·∫≠t Kh·∫©u M·ªõi</label>
          <input type="password" id="profilePassword" placeholder="Nh·∫≠p m·∫≠t kh·∫©u m·ªõi" />
        </div>
        <button onclick="updateProfile()">C·∫≠p Nh·∫≠t H·ªì S∆°</button>
      </div>
    </div>
  </div>

  <script src="config.js"></script>
  <script>
    const API_URL = CONFIG.API_URL;
    let token = localStorage.getItem("token");

    if (token) {
      showDashboard();
      loadData();
    }

    function toggleForm() {
      document.getElementById("loginForm").style.display =
        document.getElementById("loginForm").style.display === "none"
          ? "block"
          : "none";
      document.getElementById("registerForm").style.display =
        document.getElementById("registerForm").style.display === "none"
          ? "block"
          : "none";
    }

    async function login() {
      const email = document.getElementById("loginEmail").value;
      const password = document.getElementById("loginPassword").value;

      try {
        const response = await fetch(`${API_URL}/auth/login`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ email, mat_khau: password }),
        });

        const data = await response.json();

        if (response.ok) {
          localStorage.setItem("token", data.access_token);
          token = data.access_token;
          showDashboard();
          loadData();
        } else {
          showAlert("loginAlert", data.message, "error");
        }
      } catch (error) {
        showAlert("loginAlert", "L·ªói k·∫øt n·ªëi", "error");
      }
    }

    async function register() {
      const name = document.getElementById("registerName").value;
      const email = document.getElementById("registerEmail").value;
      const password = document.getElementById("registerPassword").value;
      const balance =
        parseFloat(document.getElementById("registerBalance").value) || 0;

      try {
        const response = await fetch(`${API_URL}/auth/register`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            ho_ten: name,
            email,
            mat_khau: password,
            so_du: balance,
          }),
        });

        const data = await response.json();

        if (response.ok) {
          showAlert(
            "registerAlert",
            "ƒêƒÉng k√Ω th√†nh c√¥ng! Vui l√≤ng ƒëƒÉng nh·∫≠p",
            "success"
          );
          setTimeout(() => toggleForm(), 1500);
        } else {
          showAlert("registerAlert", data.message, "error");
        }
      } catch (error) {
        showAlert("registerAlert", "L·ªói k·∫øt n·ªëi", "error");
      }
    }

    function logout() {
      localStorage.removeItem("token");
      token = null;
      document.getElementById("authContainer").style.display = "block";
      document.getElementById("dashboard").classList.remove("active");
      document.getElementById("loginForm").style.display = "block";
      document.getElementById("registerForm").style.display = "none";
    }

    function showDashboard() {
      document.getElementById("authContainer").style.display = "none";
      document.getElementById("dashboard").classList.add("active");
    }

    async function loadData() {
      await loadProfile();
      await loadStatistics();
      await loadCategories();
      await loadTransactions();
    }

    async function loadProfile() {
      try {
        const response = await fetch(`${API_URL}/user/profile`, {
          headers: { Authorization: `Bearer ${token}` },
        });

        if (response.ok) {
          const data = await response.json();
          document.getElementById("profileName").value = data.ho_ten;
          document.getElementById("profileEmail").value = data.email;
        }
      } catch (error) {
        console.error("L·ªói t·∫£i h·ªì s∆°:", error);
      }
    }

    async function loadStatistics() {
      try {
        const response = await fetch(`${API_URL}/thong-ke`, {
          headers: { Authorization: `Bearer ${token}` },
        });

        if (response.ok) {
          const data = await response.json();
          document.getElementById("monthlyIncome").textContent =
            formatCurrency(data.thu_nhap_thang_nay);
          document.getElementById("monthlyExpense").textContent =
            formatCurrency(data.chi_tieu_thang_nay);
          document.getElementById("currentBalance").textContent =
            formatCurrency(data.so_du);
        }
      } catch (error) {
        console.error("L·ªói t·∫£i th·ªëng k√™:", error);
      }
    }

    async function loadCategories() {
      try {
        const response = await fetch(`${API_URL}/danh-muc`, {
          headers: { Authorization: `Bearer ${token}` },
        });

        if (response.ok) {
          const categories = await response.json();
          const select = document.getElementById("transactionCategory");
          const tbody = document.getElementById("categoryList");

          select.innerHTML = '<option value="">Ch·ªçn danh m·ª•c</option>';

          if (categories.length === 0) {
            select.innerHTML +=
              '<option value="" disabled>‚ö†Ô∏è Ch∆∞a c√≥ danh m·ª•c - V√†o tab "Danh M·ª•c" ƒë·ªÉ t·∫°o</option>';
            tbody.innerHTML =
              '<tr><td colspan="3" style="text-align: center; color: #999;">‚ö†Ô∏è Ch∆∞a c√≥ danh m·ª•c. H√£y t·∫°o danh m·ª•c m·ªõi!</td></tr>';
            return;
          }

          // Nh√≥m theo lo·∫°i
          const chiTieu = categories.filter(
            (c) => c.loai_danh_muc === "Chi ti√™u"
          );
          const thuNhap = categories.filter(
            (c) => c.loai_danh_muc === "Thu nh·∫≠p"
          );

          if (chiTieu.length > 0) {
            select.innerHTML += '<optgroup label="üí∏ Chi Ti√™u">';
            chiTieu.forEach((cat) => {
              select.innerHTML += `<option value="${cat.id}">${cat.icon || "üìå"
                } ${cat.ten_danh_muc}</option>`;
            });
            select.innerHTML += "</optgroup>";
          }

          if (thuNhap.length > 0) {
            select.innerHTML += '<optgroup label="üí∞ Thu Nh·∫≠p">';
            thuNhap.forEach((cat) => {
              select.innerHTML += `<option value="${cat.id}">${cat.icon || "üíµ"
                } ${cat.ten_danh_muc}</option>`;
            });
            select.innerHTML += "</optgroup>";
          }

          tbody.innerHTML = "";
          categories.forEach((cat) => {
            tbody.innerHTML += `<tr>
                            <td>${cat.ten_danh_muc}</td>
                            <td>${cat.loai_danh_muc}</td>
                            <td>-</td>
                        </tr>`;
          });
        }
      } catch (error) {
        console.error("L·ªói t·∫£i danh m·ª•c:", error);
      }
    }

    function showCategorySuggestions() {
      const suggestions = {
        "Chi ti√™u": [
          { name: "ƒÇn u·ªëng", icon: "üçî" },
          { name: "Gi·∫£i tr√≠", icon: "üéÆ" },
          { name: "Mua s·∫Øm", icon: "üõí" },
          { name: "Di chuy·ªÉn", icon: "üöó" },
          { name: "H·ªçc ph√≠", icon: "üìö" },
          { name: "Y t·∫ø", icon: "üíä" },
          { name: "Nh√† c·ª≠a", icon: "üè†" },
          { name: "ƒêi·ªán n∆∞·ªõc", icon: "üí°" },
        ],
        "Thu nh·∫≠p": [
          { name: "L∆∞∆°ng", icon: "üí∞" },
          { name: "Th∆∞·ªüng", icon: "üéÅ" },
          { name: "ƒê·∫ßu t∆∞", icon: "üìà" },
          { name: "Kinh doanh", icon: "üíº" },
        ],
      };

      let message = "üìã DANH M·ª§C PH·ªî BI·∫æN:\n\n";
      message += "üí∏ CHI TI√äU:\n";
      suggestions["Chi ti√™u"].forEach(
        (s) => (message += `  ${s.icon} ${s.name}\n`)
      );
      message += "\nüí∞ THU NH·∫¨P:\n";
      suggestions["Thu nh·∫≠p"].forEach(
        (s) => (message += `  ${s.icon} ${s.name}\n`)
      );
      message += '\nüí° V√†o tab "Danh M·ª•c" ƒë·ªÉ t·∫°o danh m·ª•c m·ªõi!';

      alert(message);
    }

    async function loadTransactions() {
      try {
        const response = await fetch(`${API_URL}/giao-dich`, {
          headers: { Authorization: `Bearer ${token}` },
        });

        if (response.ok) {
          const transactions = await response.json();
          const tbody = document.getElementById("transactionList");
          tbody.innerHTML = "";

          transactions.forEach((trans) => {
            tbody.innerHTML += `<tr>
                            <td>-</td>
                            <td>${formatCurrency(trans.so_tien)}</td>
                            <td>${trans.mo_ta}</td>
                            <td>${new Date(trans.ngay).toLocaleDateString(
              "vi-VN"
            )}</td>
                        </tr>`;
          });
        }
      } catch (error) {
        console.error("L·ªói t·∫£i giao d·ªãch:", error);
      }
    }

    async function addTransaction() {
      const categoryId = document.getElementById("transactionCategory").value;
      const amount = parseFloat(
        document.getElementById("transactionAmount").value
      );
      const description = document.getElementById(
        "transactionDescription2"
      ).value;

      if (!categoryId || !amount) {
        showAlert(
          "dashboardAlert",
          "Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin",
          "error"
        );
        return;
      }

      try {
        const response = await fetch(`${API_URL}/giao-dich`, {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            Authorization: `Bearer ${token}`,
          },
          body: JSON.stringify({
            danh_muc_id: parseInt(categoryId),
            so_tien: amount,
            mo_ta: description,
          }),
        });

        if (response.ok) {
          showAlert("dashboardAlert", "Th√™m giao d·ªãch th√†nh c√¥ng", "success");
          document.getElementById("transactionAmount").value = "";
          document.getElementById("transactionDescription2").value = "";
          loadData();
        } else {
          const data = await response.json();
          showAlert("dashboardAlert", data.message, "error");
        }
      } catch (error) {
        showAlert("dashboardAlert", "L·ªói k·∫øt n·ªëi", "error");
      }
    }

    async function addCategory() {
      const type = document.getElementById("categoryType").value;
      const name = document.getElementById("categoryName2").value;
      const description = document.getElementById(
        "categoryDescription"
      ).value;

      if (!name) {
        showAlert("dashboardAlert", "Vui l√≤ng nh·∫≠p t√™n danh m·ª•c", "error");
        return;
      }

      try {
        const response = await fetch(`${API_URL}/danh-muc`, {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            Authorization: `Bearer ${token}`,
          },
          body: JSON.stringify({
            loai_danh_muc: type,
            ten_danh_muc: name,
            mo_ta: description,
          }),
        });

        if (response.ok) {
          showAlert("dashboardAlert", "Th√™m danh m·ª•c th√†nh c√¥ng", "success");
          document.getElementById("categoryName2").value = "";
          document.getElementById("categoryDescription").value = "";
          loadCategories();
        } else {
          const data = await response.json();
          showAlert("dashboardAlert", data.message, "error");
        }
      } catch (error) {
        showAlert("dashboardAlert", "L·ªói k·∫øt n·ªëi", "error");
      }
    }

    async function updateProfile() {
      const name = document.getElementById("profileName").value;
      const password = document.getElementById("profilePassword").value;

      if (!name) {
        showAlert("dashboardAlert", "Vui l√≤ng nh·∫≠p h·ªç t√™n", "error");
        return;
      }

      try {
        const body = { ho_ten: name };
        if (password) body.mat_khau = password;

        const response = await fetch(`${API_URL}/user/profile`, {
          method: "PUT",
          headers: {
            "Content-Type": "application/json",
            Authorization: `Bearer ${token}`,
          },
          body: JSON.stringify(body),
        });

        if (response.ok) {
          showAlert("dashboardAlert", "C·∫≠p nh·∫≠t h·ªì s∆° th√†nh c√¥ng", "success");
          document.getElementById("profilePassword").value = "";
        } else {
          const data = await response.json();
          showAlert("dashboardAlert", data.message, "error");
        }
      } catch (error) {
        showAlert("dashboardAlert", "L·ªói k·∫øt n·ªëi", "error");
      }
    }

    async function loadDetailedStats() {
      const month =
        document.getElementById("statMonth").value ||
        new Date().getMonth() + 1;
      const year =
        document.getElementById("statYear").value || new Date().getFullYear();

      try {
        const response = await fetch(
          `${API_URL}/thong-ke-chi-tiet?thang=${month}&nam=${year}`,
          {
            headers: { Authorization: `Bearer ${token}` },
          }
        );

        if (response.ok) {
          const stats = await response.json();
          const tbody = document.getElementById("statsList");
          tbody.innerHTML = "";

          stats.forEach((stat) => {
            tbody.innerHTML += `<tr>
                            <td>${stat.ten_danh_muc}</td>
                            <td>${stat.loai}</td>
                            <td>${formatCurrency(stat.tong)}</td>
                        </tr>`;
          });
        }
      } catch (error) {
        console.error("L·ªói t·∫£i th·ªëng k√™:", error);
      }
    }

    async function addDebt() {
      const name = document.getElementById("debtName").value;
      const type = document.getElementById("debtType").value;
      const amount = parseFloat(document.getElementById("debtAmount").value);
      const rate = parseFloat(document.getElementById("debtRate").value) || 0;
      const due = document.getElementById("debtDue").value;

      if (!name || !amount || !due) {
        showAlert(
          "dashboardAlert",
          "Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin",
          "error"
        );
        return;
      }

      try {
        const response = await fetch(`${API_URL}/vay-no`, {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            Authorization: `Bearer ${token}`,
          },
          body: JSON.stringify({
            ho_ten_vay_no: name,
            loai: type,
            so_tien: amount,
            lai_suat: rate,
            han_tra: due,
          }),
        });

        if (response.ok) {
          showAlert("dashboardAlert", "Th√™m th√†nh c√¥ng", "success");
          document.getElementById("debtName").value = "";
          document.getElementById("debtAmount").value = "";
          document.getElementById("debtRate").value = "0";
          document.getElementById("debtDue").value = "";
          loadDebts();
        }
      } catch (error) {
        showAlert("dashboardAlert", "L·ªói k·∫øt n·ªëi", "error");
      }
    }

    async function loadDebts() {
      try {
        const response = await fetch(`${API_URL}/vay-no`, {
          headers: { Authorization: `Bearer ${token}` },
        });

        if (response.ok) {
          const debts = await response.json();
          const tbody = document.getElementById("debtList");
          tbody.innerHTML = "";

          debts.forEach((debt) => {
            tbody.innerHTML += `<tr>
                            <td>${debt.ho_ten_vay_no}</td>
                            <td>${debt.loai}</td>
                            <td>${formatCurrency(debt.so_tien)}</td>
                            <td>${debt.trang_thai}</td>
                            <td>${new Date(debt.han_tra).toLocaleDateString(
              "vi-VN"
            )}</td>
                        </tr>`;
          });
        }
      } catch (error) {
        console.error("L·ªói t·∫£i vay n·ª£:", error);
      }
    }

    async function addSaving() {
      const name = document.getElementById("savingName").value;
      const target = parseFloat(
        document.getElementById("savingTarget").value
      );
      const end = document.getElementById("savingEnd").value;

      if (!name || !target || !end) {
        showAlert(
          "dashboardAlert",
          "Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin",
          "error"
        );
        return;
      }

      try {
        const response = await fetch(`${API_URL}/tich-luy`, {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            Authorization: `Bearer ${token}`,
          },
          body: JSON.stringify({
            ten_tich_luy: name,
            so_tien_muc_tieu: target,
            ngay_ket_thuc: end,
          }),
        });

        if (response.ok) {
          showAlert("dashboardAlert", "T·∫°o m·ª•c ti√™u th√†nh c√¥ng", "success");
          document.getElementById("savingName").value = "";
          document.getElementById("savingTarget").value = "";
          document.getElementById("savingEnd").value = "";
          loadSavings();
        }
      } catch (error) {
        showAlert("dashboardAlert", "L·ªói k·∫øt n·ªëi", "error");
      }
    }

    async function loadSavings() {
      try {
        const response = await fetch(`${API_URL}/tich-luy`, {
          headers: { Authorization: `Bearer ${token}` },
        });

        if (response.ok) {
          const savings = await response.json();
          const tbody = document.getElementById("savingsList");
          tbody.innerHTML = "";

          savings.forEach((saving) => {
            tbody.innerHTML += `<tr>
                            <td>${saving.ten_tich_luy}</td>
                            <td>${formatCurrency(saving.so_tien_muc_tieu)}</td>
                            <td>${saving.trang_thai}</td>
                            <td>${saving.ngay_ket_thuc
                ? new Date(
                  saving.ngay_ket_thuc
                ).toLocaleDateString("vi-VN")
                : "-"
              }</td>
                        </tr>`;
          });
        }
      } catch (error) {
        console.error("L·ªói t·∫£i ti·∫øt ki·ªám:", error);
      }
    }

    function switchTab(tab) {
      document
        .querySelectorAll(".section")
        .forEach((el) => (el.style.display = "none"));
      document
        .querySelectorAll(".nav-tabs button")
        .forEach((el) => el.classList.remove("active"));

      const tabs = {
        transactions: "transactionsTab",
        categories: "categoriesTab",
        statistics: "statisticsTab",
        debt: "debtTab",
        savings: "savingsTab",
        profile: "profileTab",
      };

      if (tabs[tab]) {
        document.getElementById(tabs[tab]).style.display = "block";
        if (tab === "statistics") loadDetailedStats();
        if (tab === "debt") loadDebts();
        if (tab === "savings") loadSavings();
      }

      event.target.classList.add("active");
    }

    function showAlert(elementId, message, type) {
      const alert = document.getElementById(elementId);
      alert.textContent = message;
      alert.className = `alert ${type}`;
      setTimeout(() => {
        alert.className = "alert";
      }, 3000);
    }

    function formatCurrency(value) {
      return new Intl.NumberFormat("vi-VN", {
        style: "currency",
        currency: "VND",
      }).format(value);
    }
  </script>
</body>

</html>